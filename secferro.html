<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SECFERRO: E-Ops Cyberwarfare - CLASSIFIED</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #030303;
            --text-primary: #00ff41;
            --text-secondary: #00ffff;
            --text-danger: #ff0040;
            --text-warning: #ffaa00;
            --text-success: #00ff88;
            --text-info: #0088ff;
            --border-glow: 0 0 20px var(--text-primary), inset 0 0 10px rgba(0, 255, 65, 0.1);
            --matrix-glow: 0 0 30px #00ff41, 0 0 60px #00ff41, 0 0 90px #00ff41;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            font-family: 'VT323', monospace;
            font-size: 16px;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.1;
            z-index: 0;
        }

        .matrix-column {
            position: absolute;
            color: var(--text-primary);
            font-family: 'VT323', monospace;
            font-size: 14px;
            animation: matrix-fall linear infinite;
        }

        @keyframes matrix-fall {
            0% { transform: translateY(-100vh); opacity: 1; }
            100% { transform: translateY(100vh); opacity: 0; }
        }

        .main-container {
            display: grid;
            grid-template-areas: 
                "header header header"
                "terminal status threats"
                "logs network intel";
            grid-template-columns: 2fr 300px 300px;
            grid-template-rows: 60px 1fr 200px;
            height: 100vh;
            gap: 10px;
            padding: 10px;
            position: relative;
            z-index: 1;
        }

        .header-panel {
            grid-area: header;
            background: linear-gradient(90deg, var(--bg-secondary), rgba(0, 255, 65, 0.1));
            border: 2px solid var(--text-primary);
            box-shadow: var(--border-glow);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Orbitron', monospace;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            text-shadow: var(--matrix-glow);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .classification {
            background: var(--text-danger);
            color: #000;
            padding: 5px 15px;
            border-radius: 4px;
            font-weight: 700;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .terminal-container {
            grid-area: terminal;
            background: linear-gradient(135deg, var(--bg-secondary), rgba(0, 255, 65, 0.05));
            border: 2px solid var(--text-primary);
            box-shadow: var(--border-glow);
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .terminal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--text-primary);
        }

        .terminal-title {
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            color: var(--text-secondary);
        }

        .security-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .encryption-status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--text-success);
            box-shadow: 0 0 10px var(--text-success);
            animation: pulse 1.5s infinite;
        }

        #terminal-output {
            flex-grow: 1;
            overflow-y: auto;
            font-size: 14px;
            line-height: 1.4;
            padding-right: 10px;
            scrollbar-width: thin;
            scrollbar-color: var(--text-primary) transparent;
        }

        #terminal-output::-webkit-scrollbar {
            width: 6px;
        }

        #terminal-output::-webkit-scrollbar-track {
            background: transparent;
        }

        #terminal-output::-webkit-scrollbar-thumb {
            background: var(--text-primary);
            border-radius: 3px;
        }

        .terminal-input-line {
            display: flex;
            align-items: center;
            padding-top: 10px;
            border-top: 1px solid rgba(0, 255, 65, 0.3);
            margin-top: 10px;
            position: relative;
        }

        #prompt {
            color: var(--text-secondary);
            font-weight: bold;
            margin-right: 10px;
        }

        #terminal-input {
            flex-grow: 1;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-family: inherit;
            font-size: inherit;
            outline: none;
            caret-color: var(--text-primary);
        }

        .autocomplete-container {
            position: absolute;
            bottom: 100%;
            left: 0;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid var(--text-info);
            border-radius: 4px;
            padding: 5px;
            max-height: 150px;
            overflow-y: auto;
            font-size: 12px;
            width: 100%;
            display: none;
        }

        .autocomplete-item {
            padding: 5px;
            cursor: pointer;
        }

        .autocomplete-item.active,
        .autocomplete-item:hover {
            background: rgba(0, 136, 255, 0.2);
        }

        .status-panel {
            grid-area: status;
            background: linear-gradient(135deg, var(--bg-secondary), rgba(0, 136, 255, 0.05));
            border: 2px solid var(--text-info);
            box-shadow: 0 0 20px var(--text-info);
            border-radius: 8px;
            padding: 15px;
        }

        .threats-panel {
            grid-area: threats;
            background: linear-gradient(135deg, var(--bg-secondary), rgba(255, 0, 64, 0.05));
            border: 2px solid var(--text-danger);
            box-shadow: 0 0 20px var(--text-danger);
            border-radius: 8px;
            padding: 15px;
        }

        .logs-panel {
            grid-area: logs;
            background: linear-gradient(135deg, var(--bg-secondary), rgba(255, 170, 0, 0.05));
            border: 2px solid var(--text-warning);
            box-shadow: 0 0 20px var(--text-warning);
            border-radius: 8px;
            padding: 15px;
            overflow: hidden;
        }

        .network-panel {
            grid-area: network;
            background: linear-gradient(135deg, var(--bg-secondary), rgba(0, 255, 136, 0.05));
            border: 2px solid var(--text-success);
            box-shadow: 0 0 20px var(--text-success);
            border-radius: 8px;
            padding: 15px;
        }

        .intel-panel {
            grid-area: intel;
            background: linear-gradient(135deg, var(--bg-secondary), rgba(0, 255, 255, 0.05));
            border: 2px solid var(--text-secondary);
            box-shadow: 0 0 20px var(--text-secondary);
            border-radius: 8px;
            padding: 15px;
        }

        .panel-title {
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 10px;
            text-align: center;
            text-transform: uppercase;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 12px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: var(--text-success);
            transition: width 0.3s ease;
            box-shadow: 0 0 10px var(--text-success);
        }

        .threat-item {
            background: rgba(255, 0, 64, 0.1);
            padding: 8px;
            margin-bottom: 5px;
            border-radius: 4px;
            border-left: 3px solid var(--text-danger);
            font-size: 11px;
        }

        .log-entry {
            font-size: 10px;
            color: var(--text-warning);
            margin-bottom: 3px;
            padding: 2px 5px;
            background: rgba(255, 170, 0, 0.1);
            border-radius: 2px;
        }

        .network-node {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin: 2px;
            animation: network-pulse 2s infinite;
        }

        .node-secure { background: var(--text-success); box-shadow: 0 0 5px var(--text-success); }
        .node-warning { background: var(--text-warning); box-shadow: 0 0 5px var(--text-warning); }
        .node-danger { background: var(--text-danger); box-shadow: 0 0 5px var(--text-danger); }

        @keyframes network-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
        }

        .intel-item {
            background: rgba(0, 255, 255, 0.1);
            padding: 8px;
            margin-bottom: 5px;
            border-radius: 4px;
            font-size: 11px;
            border-left: 3px solid var(--text-secondary);
        }

        .command-suggestion {
            background: rgba(0, 255, 65, 0.1);
            padding: 5px;
            margin: 5px 0;
            border-radius: 3px;
            font-size: 12px;
            border-left: 2px solid var(--text-primary);
        }

        .alert { color: var(--text-danger); font-weight: bold; }
        .success { color: var(--text-success); font-weight: bold; }
        .info { color: var(--text-info); }
        .warning { color: var(--text-warning); font-weight: bold; }

        .documentation-container {
            grid-area: docs;
            grid-column: 1 / -1;
            background: linear-gradient(135deg, var(--bg-secondary), rgba(0, 255, 136, 0.05));
            border: 2px solid var(--text-success);
            box-shadow: 0 0 20px var(--text-success);
            border-radius: 8px;
            padding: 20px;
            margin-top: 10px;
        }

        .documentation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 18px;
            color: var(--text-success);
        }

        .documentation-content {
            display: none;
            margin-top: 20px;
            font-size: 14px;
            line-height: 1.5;
        }

        .documentation-content h3 {
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .documentation-content pre {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 4px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .documentation-content p {
            margin-bottom: 10px;
        }

        .collapsible-section {
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 4px;
            margin-top: 10px;
            padding: 10px;
        }
        
        @media (max-width: 1200px) {
            .main-container {
                grid-template-areas: 
                    "header header"
                    "terminal status"
                    "logs threats";
                grid-template-columns: 1fr 300px;
                grid-template-rows: 60px 1fr 200px;
            }
            .network-panel, .intel-panel { display: none; }
        }

        @media (max-width: 768px) {
            .main-container {
                grid-template-areas: 
                    "header"
                    "terminal"
                    "status";
                grid-template-columns: 1fr;
                grid-template-rows: 60px 1fr 200px;
            }
            .threats-panel, .logs-panel, .network-panel, .intel-panel { display: none; }
        }
    </style>
</head>
<body>
    <div class="matrix-bg" id="matrix-bg"></div>
    
    <div class="main-container">
        <div class="header-panel">
            <div class="logo">SECFERRO: E-OPS</div>
            <div>
                <span style="color: var(--text-info); font-size: 14px;">Agent ID: </span>
                <span id="agent-id">SEC-7741</span>
            </div>
            <div class="classification">TOP SECRET</div>
        </div>

        <div class="terminal-container">
            <div class="terminal-header">
                <div class="terminal-title">Secure Terminal</div>
                <div class="security-indicator">
                    <span style="font-size: 12px;">AES-256</span>
                    <div class="encryption-status"></div>
                </div>
            </div>
            <pre id="terminal-output"></pre>
            <div class="terminal-input-line">
                <span id="prompt">root@secferro:/#</span>
                <input type="text" id="terminal-input" autocomplete="off" autocorrect="off" spellcheck="false">
                <div id="autocomplete-container" class="autocomplete-container"></div>
            </div>
        </div>

        <div class="status-panel">
            <div class="panel-title" style="color: var(--text-info);">System Status</div>
            <div class="status-item">
                <span>Security Level:</span>
                <span id="security-level">MAXIMUM</span>
            </div>
            <div class="status-item">
                <span>Reputation:</span>
                <span id="reputation">100</span>
            </div>
            <div class="progress-bar">
                <div id="reputation-fill" class="progress-fill" style="width: 100%"></div>
            </div>
            <div class="status-item">
                <span>Mission Status:</span>
                <span id="mission-status">STANDBY</span>
            </div>
            <div class="status-item">
                <span>Uptime:</span>
                <span id="uptime">0s</span>
            </div>
            <div class="status-item">
                <span>CPU Load:</span>
                <span id="cpu-load">0%</span>
            </div>
            <div class="status-item">
                <span>Memory:</span>
                <span id="memory-usage">2.1GB</span>
            </div>
        </div>

        <div class="threats-panel">
            <div class="panel-title" style="color: var(--text-danger);">Threat Monitor</div>
            <div id="threats-list">
                <div class="threat-item">
                    <strong>LOW:</strong> Port scan detected<br>
                    <small>Source: 192.168.1.100</small>
                </div>
                <div class="threat-item">
                    <strong>MEDIUM:</strong> Suspicious login attempt<br>
                    <small>Target: SSH service</small>
                </div>
            </div>
        </div>

        <div class="logs-panel">
            <div class="panel-title" style="color: var(--text-warning);">Security Logs</div>
            <div id="logs-container"></div>
        </div>

        <div class="network-panel">
            <div class="panel-title" style="color: var(--text-success);">Network Map</div>
            <div style="text-align: center; margin-top: 20px;">
                <div class="network-node node-secure"></div>
                <div class="network-node node-secure"></div>
                <div class="network-node node-warning"></div>
                <div class="network-node node-secure"></div>
                <br>
                <div class="network-node node-secure"></div>
                <div class="network-node node-danger"></div>
                <div class="network-node node-secure"></div>
                <div class="network-node node-secure"></div>
                <br>
                <div class="network-node node-secure"></div>
                <div class="network-node node-secure"></div>
                <div class="network-node node-secure"></div>
                <div class="network-node node-warning"></div>
            </div>
            <div style="font-size: 10px; margin-top: 10px;">
                <div><span class="network-node node-secure"></span> Secure (12)</div>
                <div><span class="network-node node-warning"></span> Warning (3)</div>
                <div><span class="network-node node-danger"></span> Compromised (1)</div>
            </div>
        </div>

        <div class="intel-panel">
            <div class="panel-title" style="color: var(--text-secondary);">Intelligence</div>
            <div class="intel-item">
                <strong>OSINT:</strong> New vulnerability disclosed<br>
                <small>CVE-2024-9876 (Critical)</small>
            </div>
            <div class="intel-item">
                <strong>HUMINT:</strong> Social engineering campaign detected<br>
                <small>Targeting financial sector</small>
            </div>
        </div>
    </div>

    <script>
        class SecFerroSystem {
            constructor() {
                this.state = {
                    mission: 'boot',
                    subTask: 0,
                    reputation: 100,
                    securityLevel: 'MAXIMUM',
                    cpuLoad: 0,
                    startTime: Date.now(),
                    isExecuting: false,
                    difficulty: 'elite',
                    currentPath: '/',
                    agentId: 'SEC-7741',
                    encryptionLevel: 'AES-256',
                    
                    currentMission: null,
                    currentMissionPhase: null,
                    
                    fs: {
                        '/': ['home', 'etc', 'var', 'opt', 'usr', 'root', 'bin'],
                        '/home': ['agent', 'analyst', 'admin'],
                        '/home/agent': ['missions', 'tools', 'intel', 'secure'],
                        '/home/agent/tools': ['nmap', 'metasploit', 'burp', 'wireshark', 'volatility', 'ghidra'],
                        '/home/agent/missions': ['red_team', 'blue_team', 'purple_team', 'forensics'],
                        '/home/agent/intel': ['osint', 'humint', 'sigint', 'geoint'],
                        '/home/agent/secure': ['encrypted_comms', 'crypto_keys', 'steganography'],
                        '/etc': ['passwd', 'shadow', 'hosts', 'network.conf', 'security.conf'],
                        '/var': ['log', 'spool', 'cache'],
                        '/var/log': ['auth.log', 'kern.log', 'syslog', 'secure.log', 'audit.log'],
                        '/opt': ['secferro', 'custom_tools'],
                        '/opt/secferro': ['framework', 'modules', 'payloads'],
                        '/usr': ['bin', 'sbin', 'lib'],
                        '/bin': ['ls', 'cd', 'cat', 'help', 'mission', 'start', 'clear', 'exit', 'ifconfig', 'ping', 'targets', 'assess', 'exploit'],
                        '/root': ['classified', 'operations']
                    },

                    fileContent: {
                        '/etc/security.conf': `# SECFERRO Security Configuration
encryption_level=AES-256
authentication=multi_factor
logging_level=verbose
threat_detection=active
firewall_status=enabled
ids_status=active
honeypot_enabled=true`,
                        '/var/log/secure.log': `[2024-01-15 14:32:01] SSH: Failed login attempt from 203.0.113.45
[2024-01-15 14:32:15] SSH: Successful login: agent@secferro
[2024-01-15 14:45:22] FIREWALL: Blocked connection from 192.168.1.200
[2024-01-15 15:01:33] IDS: Suspicious network traffic detected
[2024-01-15 15:15:44] AUTH: Multi-factor authentication successful`,
                        '/home/agent/intel/osint': `TARGET ANALYSIS REPORT - CLASSIFIED
========================================
Domain: target-corp.example.com
Email Pattern: firstname.lastname@target-corp.com
Technology Stack: WordPress 6.1, Apache 2.4, MySQL 8.0
Social Media Presence: High LinkedIn activity
Key Personnel: CTO John Smith, CISO Jane Doe
Vulnerabilities: CVE-2023-1234 (WordPress), Weak password policy`,
                        '/home/agent/missions/red_team': `RED TEAM OPERATION: CRIMSON SHADOW
=====================================
Objective: Gain administrative access to target infrastructure
Phase 1: Reconnaissance [COMPLETED]
Phase 2: Initial Access [IN PROGRESS]
Phase 3: Persistence [PENDING]
Phase 4: Privilege Escalation [PENDING]
Phase 5: Data Exfiltration [PENDING]
Phase 6: Cleanup [PENDING]`
                    },

                    missions: {
                        red_team: {
                            name: 'OPERATION: CRIMSON SHADOW',
                            objective: 'Penetrate target infrastructure',
                            phases: ['recon', 'access', 'persist', 'escalate', 'exfil', 'cleanup'],
                            commands: {
                                'recon': ['nmap', 'osint', 'vulnerability-scan'],
                                'access': ['metasploit', 'phishing', 'burp'],
                                'persist': ['steganography'],
                                'escalate': ['volatility'],
                                'exfil': ['crypto-analysis'],
                                'cleanup': ['threat-hunt']
                            }
                        },
                        blue_team: {
                            name: 'OPERATION: BLUE SHIELD',
                            objective: 'Defend against active threats',
                            phases: ['monitor', 'analyze', 'respond', 'contain', 'remediate'],
                            commands: {
                                'monitor': ['wireshark', 'threat-hunt'],
                                'analyze': ['malware-analysis', 'ghidra'],
                                'respond': ['incident-response'],
                                'contain': ['honeypot', 'zero-trust'],
                                'remediate': ['compliance-audit']
                            }
                        },
                        purple_team: {
                            name: 'OPERATION: VIOLET STORM',
                            objective: 'Collaborative security improvement',
                            phases: ['plan', 'execute', 'evaluate', 'improve'],
                            commands: {
                                'plan': ['threat-modeling', 'risk-assessment'],
                                'execute': ['devsecops', 'ai-security'],
                                'evaluate': ['vulnerability-scan'],
                                'improve': ['cloud-security', 'iot-security']
                            }
                        }
                    },

                    threats: [
                        { level: 'CRITICAL', description: 'APT29 indicators detected', source: 'SIGINT' },
                        { level: 'HIGH', description: 'Zero-day exploit in the wild', source: 'OSINT' },
                        { level: 'MEDIUM', description: 'Phishing campaign active', source: 'HUMINT' },
                        { level: 'LOW', description: 'Port scan activity', source: 'IDS' }
                    ],
                    
                    targets: [
                        { 
                            name: 'target-corp.com', 
                            ip: '172.16.1.10', 
                            vulnerabilities: ['WordPress 6.1 (CVE-2023-1234)', 'Weak email security (SPF/DKIM)'],
                            openPorts: [22, 80, 443, 3306],
                            osintInfo: `Domain: target-corp.com
Email Pattern: firstname.lastname@target-corp.com
Technology Stack: Apache, WordPress, MySQL
Social Media Presence: High LinkedIn activity
Key Personnel: Found various public profiles
Identified Vulnerabilities: WordPress 6.1 (CVE-2023-1234), Weak email security (SPF/DKIM)`,
                            vulnerabilityReport: `VULNERABILITY ASSESSMENT: target-corp.com
------------------------------------------
Identified Vulnerability: WordPress 6.1 (CVE-2023-1234)
  Severity: CRITICAL
  CVSS Score: 9.8
  Description: Authenticated arbitrary code execution via file upload.
  Exploitability: HIGH - Publicly available proof-of-concept.
  Mitigation: Update WordPress to version 6.2 or later.`,
                            exploitResult: `EXPLOIT SUCCESSFUL!
-------------------
Vulnerability: WordPress 6.1 (CVE-2023-1234)
Target: target-corp.com
Payload: reverse_shell
Session established. New session ID: 4893.
Now entering lateral movement phase.`
                        },
                        { 
                            name: 'legacy-server', 
                            ip: '10.0.0.5', 
                            vulnerabilities: ['SSH with weak ciphers', 'Outdated web server (Apache 2.2)'],
                            openPorts: [22, 80, 21],
                            osintInfo: `Domain: legacy-server
Technology Stack: Apache 2.2, OpenSSH
Known Weaknesses: End-of-Life software, poor patch management
Identified Vulnerabilities: SSH with weak ciphers, Outdated web server (Apache 2.2)`,
                            vulnerabilityReport: `VULNERABILITY ASSESSMENT: legacy-server
------------------------------------------
Identified Vulnerability: SSH with weak ciphers
  Severity: HIGH
  CVSS Score: 8.4
  Description: The server accepts weak cryptographic algorithms, making it susceptible to brute-force attacks and man-in-the-middle attacks.
  Exploitability: MEDIUM - Requires specialized tools.
  Mitigation: Disable weak ciphers in sshd_config.`,
                            exploitResult: `EXPLOIT FAILED!
-------------------
Vulnerability: SSH weak ciphers
Target: legacy-server
Reason: Insufficient credentials. The brute-force attack was detected and blocked by the intrusion prevention system.`
                        },
                        { 
                            name: 'iot-net', 
                            ip: '192.168.20.1', 
                            vulnerabilities: ['Default credentials', 'Open management ports'],
                            openPorts: [8080, 8443],
                            osintInfo: `Domain: iot-net
Device Type: IoT Gateway
Known Weaknesses: Default factory credentials, lack of encryption on management interface
Identified Vulnerabilities: Default credentials`,
                            vulnerabilityReport: `VULNERABILITY ASSESSMENT: iot-net
------------------------------------------
Identified Vulnerability: Default credentials
  Severity: HIGH
  CVSS Score: 8.8
  Description: The device is configured with factory-default usernames and passwords, which are publicly known.
  Exploitability: VERY HIGH - Trivial to exploit.
  Mitigation: Change default credentials immediately.`,
                            exploitResult: `EXPLOIT SUCCESSFUL!
-------------------
Vulnerability: Default credentials
Target: iot-net
Payload: firmware_injection
Device compromised. Gained access to local network.`
                        }
                    ],

                    networkNodes: {
                        secure: 12,
                        warning: 3,
                        compromised: 1
                    }
                };
                
                this.availableCommands = [
                    'ls', 'cd', 'cat', 'help', 'mission', 'start', 'clear', 'exit', 'ifconfig', 'ping', 'targets', 'assess', 'exploit',
                    'osint', 'nmap', 'metasploit', 'burp', 'wireshark', 'volatility', 'ghidra',
                    'threat-hunt', 'incident-response', 'malware-analysis', 'vulnerability-scan',
                    'social-engineering', 'crypto-analysis', 'steganography', 'honeypot',
                    'threat-modeling', 'compliance-audit', 'risk-assessment', 'zero-trust',
                    'devsecops', 'ai-security', 'quantum-crypto', 'blockchain-analysis',
                    'iot-security', 'cloud-security'
                ];
                
                this.commandHistory = [];
                this.historyIndex = -1;

                this.initializeSystem();
                this.startMatrixEffect();
                this.startSystemMonitoring();
            }

            initializeSystem() {
                this.output = document.getElementById('terminal-output');
                this.input = document.getElementById('terminal-input');
                this.prompt = document.getElementById('prompt');
                this.autocompleteContainer = document.getElementById('autocomplete-container');
                
                this.input.addEventListener('keydown', (e) => this.handleInput(e));
                this.input.addEventListener('input', () => this.handleAutocomplete());
                
                this.startBootSequence();
            }

            startMatrixEffect() {
                const matrixBg = document.getElementById('matrix-bg');
                const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()';
                
                for (let i = 0; i < 50; i++) {
                    const column = document.createElement('div');
                    column.className = 'matrix-column';
                    column.style.left = Math.random() * 100 + '%';
                    column.style.animationDelay = Math.random() * 5 + 's';
                    column.style.animationDuration = (Math.random() * 5 + 5) + 's';
                    
                    let text = '';
                    for (let j = 0; j < 20; j++) {
                        text += chars[Math.floor(Math.random() * chars.length)] + '\n';
                    }
                    column.textContent = text;
                    matrixBg.appendChild(column);
                }
            }

            startBootSequence() {
                const bootMessages = [
                    '[INIT] SECFERRO Kernel v5.2.0-classified loading...',
                    '[INIT] Initializing quantum encryption modules...',
                    '[INIT] Loading neural threat detection algorithms...',
                    '[INIT] Establishing secure communication channels...',
                    '[INIT] Activating advanced persistent threat countermeasures...',
                    '[INIT] Synchronizing with global intelligence networks...',
                    '[READY] All systems operational. Security level: MAXIMUM',
                    '',
                    '╔══════════════════════════════════════════╗',
                    '║          SECFERRO E-OPS PLATFORM         ║',
                    '║            CLASSIFIED ACCESS             ║',
                    '╚══════════════════════════════════════════╝',
                    '',
                    'Type "help" for available commands.',
                    'Type "mission" to view active operations.',
                    ''
                ];

                let i = 0;
                const bootInterval = setInterval(() => {
                    if (i < bootMessages.length) {
                        this.writeOutput(bootMessages[i], i < 7 ? 'info' : '');
                        i++;
                    } else {
                        clearInterval(bootInterval);
                        this.state.mission = 'ready';
                        this.input.focus();
                        this.updatePrompt();
                    }
                }, 500);
            }

            startSystemMonitoring() {
                setInterval(() => {
                    this.updateSystemStats();
                    this.updateThreatFeed();
                    this.updateSecurityLogs();
                }, 5000);

                setInterval(() => {
                    const uptime = Math.floor((Date.now() - this.state.startTime) / 1000);
                    document.getElementById('uptime').textContent = `${uptime}s`;
                }, 1000);
            }

            updateSystemStats() {
                this.state.cpuLoad = Math.floor(Math.random() * 30) + 5;
                document.getElementById('cpu-load').textContent = `${this.state.cpuLoad}%`;

                document.getElementById('reputation').textContent = this.state.reputation;
                document.getElementById('reputation-fill').style.width = `${this.state.reputation}%`;

                document.getElementById('mission-status').textContent = 
                    this.state.currentMission ? `${this.state.currentMission.toUpperCase()} - ${this.state.currentMissionPhase.toUpperCase()}` : 'STANDBY';
            }

            updateThreatFeed() {
                const threats = document.getElementById('threats-list');
                if (Math.random() < 0.3) {
                    const newThreat = document.createElement('div');
                    newThreat.className = 'threat-item';
                    const threatTypes = [
                        'Brute force attack detected',
                        'Malware signature found',
                        'Suspicious DNS query',
                        'Anomalous network traffic',
                        'Failed authentication spike'
                    ];
                    const threat = threatTypes[Math.floor(Math.random() * threatTypes.length)];
                    newThreat.innerHTML = `<strong>NEW:</strong> ${threat}<br><small>Time: ${new Date().toLocaleTimeString()}</small>`;
                    threats.insertBefore(newThreat, threats.firstChild);
                    
                    while (threats.children.length > 5) {
                        threats.removeChild(threats.lastChild);
                    }
                }
            }

            updateSecurityLogs() {
                const logs = document.getElementById('logs-container');
                if (Math.random() < 0.4) {
                    const logEntry = document.createElement('div');
                    logEntry.className = 'log-entry';
                    const logTypes = [
                        'SSH connection established',
                        'Firewall rule triggered',
                        'IDS alert generated',
                        'User authentication successful',
                        'System backup completed',
                        'Vulnerability scan finished'
                    ];
                    const log = logTypes[Math.floor(Math.random() * logTypes.length)];
                    logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${log}`;
                    logs.insertBefore(logEntry, logs.firstChild);
                    
                    while (logs.children.length > 10) {
                        logs.removeChild(logs.lastChild);
                    }
                }
            }

            writeOutput(text, className = '') {
                const div = document.createElement('div');
                div.textContent = text;
                if (className) div.className = className;
                this.output.appendChild(div);
                this.output.scrollTop = this.output.scrollHeight;
            }

            handleAutocomplete() {
                const inputVal = this.input.value.toLowerCase();
                if (!inputVal) {
                    this.autocompleteContainer.style.display = 'none';
                    return;
                }

                const suggestions = this.availableCommands.filter(cmd => cmd.startsWith(inputVal));
                
                this.autocompleteContainer.innerHTML = '';
                if (suggestions.length > 0) {
                    suggestions.forEach(suggestion => {
                        const item = document.createElement('div');
                        item.className = 'autocomplete-item';
                        item.textContent = suggestion;
                        item.onclick = () => {
                            this.input.value = suggestion;
                            this.autocompleteContainer.style.display = 'none';
                            this.input.focus();
                        };
                        this.autocompleteContainer.appendChild(item);
                    });
                    this.autocompleteContainer.style.display = 'block';
                } else {
                    this.autocompleteContainer.style.display = 'none';
                }
            }

            handleInput(e) {
                if (e.key === 'Enter') {
                    const fullCommand = this.input.value.trim();
                    if (fullCommand === '') {
                        this.writeOutput(this.prompt.textContent);
                        return;
                    }
                    this.commandHistory.push(fullCommand);
                    this.historyIndex = this.commandHistory.length;

                    this.executeCommand(fullCommand);
                    this.input.value = '';
                    this.autocompleteContainer.style.display = 'none';
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (this.historyIndex > 0) {
                        this.historyIndex--;
                        this.input.value = this.commandHistory[this.historyIndex];
                    }
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (this.historyIndex < this.commandHistory.length - 1) {
                        this.historyIndex++;
                        this.input.value = this.commandHistory[this.historyIndex];
                    } else {
                        this.historyIndex = this.commandHistory.length;
                        this.input.value = '';
                    }
                } else if (e.key === 'Tab') {
                    e.preventDefault();
                    const inputVal = this.input.value.toLowerCase();
                    const suggestions = this.availableCommands.filter(cmd => cmd.startsWith(inputVal));
                    if (suggestions.length === 1) {
                        this.input.value = suggestions[0];
                    }
                }
            }
            
            checkMissionProgress(cmd) {
                if (!this.state.currentMission) {
                    return true;
                }

                const missionConfig = this.state.missions[this.state.currentMission];
                const currentPhase = this.state.currentMissionPhase;
                const nextPhaseIndex = missionConfig.phases.indexOf(currentPhase) + 1;
                const nextPhase = missionConfig.phases[nextPhaseIndex];

                if (missionConfig.commands[currentPhase].includes(cmd)) {
                    this.writeOutput(`[PHASE SUCCESS] Command "${cmd}" completed phase "${currentPhase}".`, 'success');
                    if (nextPhase) {
                        this.state.currentMissionPhase = nextPhase;
                        this.writeOutput(`[MISSION] Proceeding to next phase: ${nextPhase.toUpperCase()}`, 'info');
                        const nextPhaseCommands = missionConfig.commands[nextPhase].join(', ');
                        this.writeOutput(`[HINT] Try commands: ${nextPhaseCommands}`, 'info');
                    } else {
                        this.writeOutput(`[MISSION COMPLETE] Operation ${missionConfig.name} finished successfully!`, 'success');
                        this.state.currentMission = null;
                        this.state.currentMissionPhase = null;
                    }
                    return true;
                } else {
                    const validCommands = missionConfig.commands[currentPhase].join(', ');
                    this.writeOutput(`[ACCESS DENIED] Command "${cmd}" not allowed in phase "${currentPhase}".`, 'alert');
                    this.writeOutput(`[HINT] Allowed commands for this phase: ${validCommands}`, 'info');
                    return false;
                }
            }


            executeCommand(fullCommand) {
                const parts = fullCommand.split(' ');
                const cmd = parts[0].toLowerCase();
                const args = parts.slice(1);

                if (this.state.isExecuting) {
                    this.writeOutput("System jest zajęty, proszę czekać...", 'warning');
                    this.input.focus();
                    return;
                }
                
                this.writeOutput(`${this.prompt.textContent} ${fullCommand}`);
                
                if (['help', 'clear', 'exit', 'mission', 'start', 'ls', 'cd', 'cat'].includes(cmd)) {
                    switch (cmd) {
                        case 'help': this.showHelp(); break;
                        case 'ls': this.listDirectory(args[0]); break;
                        case 'cd': this.changeDirectory(args[0]); break;
                        case 'cat': this.displayFile(args[0]); break;
                        case 'mission': this.showMissions(); break;
                        case 'start': this.startMission(args[0]); break;
                        case 'clear': this.output.innerHTML = ''; break;
                        case 'exit': this.writeOutput('Connection terminated.', 'warning'); setTimeout(() => location.reload(), 2000); break;
                        default: this.writeOutput(`secferro: command not found: ${cmd}`, 'warning');
                    }
                    return;
                }

                if (!this.checkMissionProgress(cmd)) {
                    return;
                }

                switch (cmd) {
                    case 'ifconfig': this.executeIfconfig(); break;
                    case 'ping': this.executePing(args); break;
                    case 'targets': this.showTargets(); break;
                    case 'osint': this.executeOsint(args); break;
                    case 'nmap': this.executeNmap(args); break;
                    case 'assess': this.executeAssess(args); break;
                    case 'exploit': this.executeExploit(args); break;
                    case 'metasploit': this.executeMetasploit(args); break;
                    case 'wireshark': this.executeWireshark(args); break;
                    case 'volatility': this.executeVolatility(args); break;
                    case 'ghidra': this.executeGhidra(args); break;
                    case 'burp': this.executeBurp(args); break;
                    case 'phishing': this.executePhishing(args); break;
                    case 'forensics': this.executeForensics(args); break;
                    case 'threat-hunt': this.executeThreatHunt(args); break;
                    case 'incident-response': this.executeIncidentResponse(args); break;
                    case 'malware-analysis': this.executeMalwareAnalysis(args); break;
                    case 'vulnerability-scan': this.executeVulnScan(args); break;
                    case 'social-engineering': this.executeSocialEngineering(args); break;
                    case 'crypto-analysis': this.executeCryptoAnalysis(args); break;
                    case 'steganography': this.executeSteganography(args); break;
                    case 'honeypot': this.executeHoneypot(args); break;
                    case 'threat-modeling': this.executeThreatModeling(args); break;
                    case 'compliance-audit': this.executeComplianceAudit(args); break;
                    case 'risk-assessment': this.executeRiskAssessment(args); break;
                    case 'zero-trust': this.executeZeroTrust(args); break;
                    case 'devsecops': this.executeDevSecOps(args); break;
                    case 'ai-security': this.executeAISecurity(args); break;
                    case 'quantum-crypto': this.executeQuantumCrypto(args); break;
                    case 'blockchain-analysis': this.executeBlockchainAnalysis(args); break;
                    case 'iot-security': this.executeIoTSecurity(args); break;
                    case 'cloud-security': this.executeCloudSecurity(args); break;
                    default: this.writeOutput(`secferro: command not found: ${cmd}`, 'warning');
                }
            }
            
            showHelp() {
                this.writeOutput(`
SECFERRO E-OPS Command Reference
================================

NAVIGATION:
  ls [path]              - List directory contents
  cd [path]              - Change directory
  cat [file]             - Display file content
  clear                  - Clear terminal

MISSION CONTROL:
  mission                - View available operations
  start [operation]      - Begin specified operation
  targets                - Display available targets for missions

OFFENSIVE TOOLS:
  osint [target]         - Open source intelligence
  nmap [target]          - Network reconnaissance
  assess [target]        - Vulnerability assessment scan
  exploit [target]       - Exploit a target system
  metasploit [payload]   - Exploitation framework
  burp [target]          - Web application testing
  phishing [template]    - Social engineering attack

DEFENSIVE TOOLS:
  wireshark [interface]  - Network traffic analysis
  threat-hunt [ioc]      - Active threat hunting
  incident-response      - Emergency response protocols
  forensics [evidence]   - Digital forensics analysis
  honeypot              - Deception technology

ANALYSIS TOOLS:
  volatility [dump]      - Memory analysis
  ghidra [binary]        - Reverse engineering
  malware-analysis       - Malware dissection
  crypto-analysis        - Cryptographic analysis
  vulnerability-scan     - Comprehensive security scan

SYSTEM:
  ifconfig               - Display network interface configuration
  ping [target]          - Test network connectivity to a host
  exit                  - Terminate session
`, 'info');
            }
            
            showTargets() {
                let output = '\nAVAILABLE TARGETS FOR RED TEAM OPERATIONS:\n===========================================\n';
                this.state.targets.forEach(target => {
                    output += `\nHost: ${target.name}\n  IP: ${target.ip}\n  Status: Active\n`;
                });
                this.writeOutput(output, 'info');
            }

            showMissions() {
                this.writeOutput(`
ACTIVE OPERATIONS - CLASSIFICATION LEVEL: TOP SECRET
===================================================

RED TEAM OPERATIONS:
  ├── Operation Crimson Shadow    [ACTIVE]
  ├── Operation Dark Phoenix      [STANDBY]
  └── Operation Silent Storm      [PLANNED]

BLUE TEAM OPERATIONS:
  ├── Operation Blue Shield       [ACTIVE]
  ├── Operation Cyber Fortress    [MONITORING]
  └── Operation Digital Guardian  [STANDBY]

PURPLE TEAM OPERATIONS:
  ├── Operation Violet Storm      [SCHEDULED]
  └── Operation Hybrid Defense    [DEVELOPMENT]

SPECIAL OPERATIONS:
  ├── Quantum Cryptanalysis       [CLASSIFIED]
  ├── AI Adversarial Testing      [EXPERIMENTAL]
  └── Zero-Day Research           [BLACK OPS]

Usage: start [operation_name]
Example: start red_team
`, 'info');
            }

            startMission(operation) {
                const missionConfig = this.state.missions[operation];
                if (!missionConfig) {
                    this.writeOutput(`[ERROR] Unknown operation: ${operation}`, 'alert');
                    this.writeOutput('Available operations: red_team, blue_team, purple_team', 'info');
                    return;
                }

                this.state.currentMission = operation;
                this.state.currentMissionPhase = missionConfig.phases[0];

                this.writeOutput(`
OPERATION ${missionConfig.name.toUpperCase()} - INITIATED
===================================
Classification: TOP SECRET
Objective: ${missionConfig.objective}

RULES OF ENGAGEMENT:
├── No permanent damage to systems
├── Document all activities
├── Maintain operational security
├── Report all findings

MISSION PHASES:
${missionConfig.phases.map((p, i) => `${i + 1}. ${p.toUpperCase()}`).join('\n')}

[STATUS] Ready for Phase 1: ${this.state.currentMissionPhase.toUpperCase()}
[HINT] Use one of these commands to begin: ${missionConfig.commands[this.state.currentMissionPhase].join(', ')}
`, 'info');
            }

            executeIfconfig() {
                this.writeOutput(`
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.1.137  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::a00:27ff:fe2f:98d0  prefixlen 64  scopeid 0x20<link>
        ether 08:00:27:2f:98:d0  txqueuelen 1000  (Ethernet)
        RX packets 123456  bytes 98765432 (98.7 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 87654  bytes 12345678 (12.3 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 4321  bytes 345678 (345.6 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 4321  bytes 345678 (345.6 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0`, 'info');
            }

            executePing(args) {
                const target = args[0];
                if (!target) {
                    this.writeOutput('Usage: ping [target_host]', 'warning');
                    return;
                }
                
                const foundTarget = this.state.targets.find(t => t.name === target || t.ip === target);
                
                if (!foundTarget) {
                    this.writeOutput(`PING ${target} (unknown host) -> Name or service not known`, 'warning');
                    return;
                }

                this.writeOutput(`PING ${foundTarget.name} (${foundTarget.ip}) 56(84) bytes of data.`);
                let packetsSent = 0;
                let packetsReceived = 0;
                let interval = setInterval(() => {
                    if (packetsSent >= 4) {
                        clearInterval(interval);
                        this.writeOutput(`
--- ${foundTarget.name} ping statistics ---
4 packets transmitted, ${packetsReceived} received, ${((4 - packetsReceived) / 4 * 100).toFixed(0)}% packet loss, time 2500ms
rtt min/avg/max/mdev = 15.123/20.456/25.789/2.123 ms`, 'info');
                        this.input.focus();
                        return;
                    }
                    packetsSent++;
                    const pingTime = (Math.random() * 10 + 15).toFixed(2);
                    if (Math.random() > 0.1) {
                        packetsReceived++;
                        this.writeOutput(`64 bytes from ${foundTarget.ip}: icmp_seq=${packetsSent} ttl=64 time=${pingTime} ms`);
                    } else {
                        this.writeOutput(`Request timeout for icmp_seq=${packetsSent}`, 'warning');
                    }
                }, 500);
            }
            
            executeOsint(args) {
                const targetName = args[0];
                const target = this.state.targets.find(t => t.name === targetName);
                
                if (!target) {
                    this.writeOutput(`osint: target not found: ${targetName}. Use 'targets' command to see available hosts.`, 'warning');
                    return;
                }

                this.startAdvancedExecution(`Running OSINT scan on ${targetName}`, 10, 25, () => {
                    this.writeOutput(`[OSINT REPORT] - ${targetName.toUpperCase()}
========================================
${target.osintInfo}`, 'info');
                    this.addReputation(10, `OSINT scan completed for ${targetName}`);
                });
            }

            executeNmap(args) {
                const targetName = args[0];
                const target = this.state.targets.find(t => t.name === targetName);

                if (!target) {
                    this.writeOutput(`nmap: target not found: ${targetName}. Use 'targets' command to see available hosts.`, 'warning');
                    return;
                }
                
                this.startAdvancedExecution(`Scanning network ${targetName} (${target.ip})`, 15, 40, () => {
                    const portOutput = target.openPorts.map(p => `${p}/tcp    open`).join('  ');
                    this.writeOutput(`
[NMAP SCAN REPORT]
Host: ${target.name} (${target.ip}) is UP
PORT      STATE
${portOutput}
`, 'success');
                    this.addReputation(15, `Nmap scan completed for ${targetName}`);
                });
            }

            executeAssess(args) {
                const targetName = args[0];
                const target = this.state.targets.find(t => t.name === targetName);

                if (!target) {
                    this.writeOutput(`assess: target not found: ${targetName}. Use 'targets' command.`, 'warning');
                    return;
                }

                this.startAdvancedExecution(`Running vulnerability assessment on ${targetName}`, 20, 50, () => {
                    this.writeOutput(`${target.vulnerabilityReport}`, 'success');
                    this.addReputation(20, `Vulnerability assessment on ${targetName} completed`);
                });
            }

            executeExploit(args) {
                const targetName = args[0];
                const target = this.state.targets.find(t => t.name === targetName);

                if (!target) {
                    this.writeOutput(`exploit: target not found: ${targetName}.`, 'warning');
                    return;
                }
                
                this.startAdvancedExecution(`Attempting to exploit ${targetName}`, 30, 80, () => {
                    this.writeOutput(`${target.exploitResult}`, 'success');
                    this.addReputation(50, `Successful exploit of ${targetName}`);
                });
            }

            executeMetasploit(args) {
                const payload = args[0] || 'windows/x64/meterpreter/reverse_tcp';
                this.startAdvancedExecution(`Loading Metasploit with ${payload}`, 20, 70, () => {
                    this.writeOutput(`
[*] Starting Metasploit Framework
[*] Loading payload: ${payload}
[*] Generating shellcode...
[*] Payload size: 4096 bytes
[*] Starting handler...

[+] Exploit completed successfully!
[*] Sending stage (201283 bytes) to 192.168.1.100
[*] Meterpreter session 1 opened

meterpreter> sysinfo
Computer: TARGET-WORKSTATION
OS: Windows 10 Build 19044
Architecture: x64
System Language: en_US
Domain: CORPORATE
Logged On Users: 2

[+] Privilege escalation successful - SYSTEM level access gained!
`, 'success');
                    this.addReputation(25, 'Successful exploitation');
                });
            }
            
            executeWireshark(args) {
                const iface = args[0] || 'eth0';
                this.startAdvancedExecution(`Capturing packets on interface ${iface}`, 25, 60, () => {
                    this.writeOutput(`
[WIRESHARK] Packet Capture Report on ${iface}
------------------------------------
Time         Source          Destination     Protocol Length Info
21:30:01     192.168.1.100   172.16.1.10     TCP      74     443 > 52345 [SYN] Seq=0
21:30:01     172.16.1.10     192.168.1.100   TCP      74     52345 > 443 [SYN, ACK] Seq=0 Ack=1
21:30:02     192.168.1.100   172.16.1.10     TLSv1.2  1514   Application Data
21:30:03     192.168.1.100   203.0.113.5     DNS      83     Standard query A iot-device.local
21:30:03     203.0.113.5     192.168.1.100   DNS      119    Standard query response A 192.168.20.1
`, 'info');
                    this.addReputation(15, 'Network analysis completed');
                });
            }

            executeVolatility(args) {
                const dump = args[0] || 'memdump.dmp';
                this.startAdvancedExecution(`Analyzing memory dump: ${dump}`, 40, 90, () => {
                    this.writeOutput(`
[VOLATILITY] Memory Analysis Report
----------------------------------
[*] Finding active processes...
  PID   Name               PPHID  Threads  Handles  SessionID
  452   System Idle Process  0      48       432      0
  1124  explorer.exe         872    123      987      1
  3456  powershell.exe       1124   20       256      1
  
[*] Scanning for malicious code injection...
  [+] Found suspicious code injection in powershell.exe at 0x7ffd1a3b0000
  [+] Detected reverse shell payload from 10.0.0.5

[CRITICAL ALERT] Malicious activity identified in memory.
`, 'alert');
                    this.addReputation(30, 'Memory forensics successful');
                });
            }

            executeGhidra(args) {
                const binary = args[0] || 'malware.bin';
                this.startAdvancedExecution(`Reverse engineering binary: ${binary}`, 60, 95, () => {
                    this.writeOutput(`
[GHIDRA] Reverse Engineering Analysis
----------------------------------
[*] Disassembling ${binary}...
[*] Analyzing functions and data flow...

[*] Found suspicious function "decrypt_data" at 0x00401010
  - Calls: AES_decrypt, base64_decode
  - Local vars: encrypted_key, salt, iv
  - Function seems to decrypt sensitive data before exfiltration.

[*] Identified network connection to C2 server 8.8.4.4.
  - Hardcoded IP in function "connect_c2"

[RESULT] Confirmed malware binary. C2 server identified.
`, 'success');
                    this.addReputation(40, 'Reverse engineering completed');
                });
            }

            executeBurp(args) {
                const target = args[0] || 'web.example.com';
                this.startAdvancedExecution(`Running Burp Suite scan on ${target}`, 20, 50, () => {
                    this.writeOutput(`
[BURP SUITE] Web Application Scan Report for ${target}
------------------------------------------
[*] Vulnerabilities Found:
  - High: SQL Injection in login form
  - Medium: Cross-Site Scripting (XSS) in search bar
  - Low: Missing security headers

[*] Discovered Endpoints:
  - /api/v1/users (GET, POST)
  - /admin/dashboard (Requires authentication)

[RECOMMENDATION] Patch login form against SQLi. Sanitize search input.
`, 'success');
                    this.addReputation(20, 'Web application assessment finished');
                });
            }
            
            executePhishing(args) {
                const template = args[0] || 'password_reset_v1';
                this.startAdvancedExecution(`Simulating phishing campaign with template: ${template}`, 10, 20, () => {
                    this.writeOutput(`
[PHISHING] Campaign Execution Report
------------------------------------
[*] Template used: ${template}
[*] Targets: 100 corporate emails
[*] Results:
  - Emails sent: 98
  - Emails delivered: 95
  - Open rate: 35%
  - Click-through rate: 15%
  - Credentials harvested: 3

[WARNING] 3 users compromised. Credential harvesting successful.
`, 'warning');
                    this.addReputation(10, 'Phishing simulation successful');
                });
            }
            
            executeThreatHunt(args) {
                const ioc = args[0] || 'default';
                this.startAdvancedExecution(`Executing threat hunt protocol for IOC: ${ioc}`, 30, 80, () => {
                    this.writeOutput(`
[THREAT HUNT] Analysis Report
-----------------------------
[*] Scanning network for indicators of compromise...
  - Checking firewall logs for outbound connections to known C2 servers...
  - Scanning host endpoints for malicious files...
  
[+] Found suspicious process: winupdater.exe
  - Hash: 5f4e6c7d8a9b1c2d3e4f5a6b7c8d9e0f
  - Process is making DNS queries to a known malicious domain.

[SUCCESS] Malicious activity identified and isolated.
`, 'success');
                    this.addReputation(25, 'Threat hunt completed');
                });
            }
            
            executeIncidentResponse(args) {
                this.startAdvancedExecution('Initiating Incident Response protocol...', 20, 50, () => {
                    this.writeOutput(`
[IR] Incident Response Protocol
-------------------------------
Phase 1: Preparation       [COMPLETE]
Phase 2: Identification    [IN PROGRESS]
  - Scanning for affected systems...
  - Verifying scope of compromise...
  
[STATUS] All affected systems have been contained.
`, 'success');
                    this.addReputation(20, 'Incident response protocol executed');
                });
            }

            executeMalwareAnalysis(args) {
                const malware = args[0] || 'sample.exe';
                this.startAdvancedExecution(`Analyzing malware sample: ${malware}`, 30, 70, () => {
                    this.writeOutput(`
[MALWARE ANALYSIS] Report
-----------------------------
[*] Sample Name: ${malware}
[*] Static Analysis:
  - File Type: PE32 executable (GUI)
  - Packing: UPX
  - Found strings: "http://malicious-c2.net/payload", "C:\\Users\\Public\\malware.dll"
[*] Dynamic Analysis:
  - Dropped files: malware.dll
  - Registry modifications: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run
  - Network connections: Initiated TCP connection to 1.2.3.4 on port 8080.
  
[SUMMARY] Confirmed dropper and backdoor functionality.
`, 'success');
                    this.addReputation(30, 'Malware analysis completed');
                });
            }
            
            executeVulnScan(args) {
                const target = args[0] || '192.168.1.1/24';
                this.startAdvancedExecution(`Executing comprehensive vulnerability scan on ${target}`, 45, 85, () => {
                    this.writeOutput(`
[VULNERABILITY SCAN] Report
-----------------------------
[*] Target: ${target}
[*] Critical Vulnerabilities: 
  - CVE-2023-4567 (Remote Code Execution)
  - CVE-2023-8901 (Default Credentials)
[*] High Vulnerabilities:
  - SSH weak ciphers
[*] Medium Vulnerabilities:
  - Outdated software (Apache 2.2)
  - Missing security headers
[*] Scan complete. Found 2 critical, 1 high, and 2 medium vulnerabilities.
`, 'success');
                    this.addReputation(35, 'Vulnerability scan completed');
                });
            }
            
            executeSocialEngineering(args) {
                const target = args[0] || 'CEO';
                this.startAdvancedExecution(`Executing social engineering campaign on ${target}`, 15, 30, () => {
                    this.writeOutput(`
[SOCIAL ENGINEERING] Report
-------------------------------
[*] Target: ${target}
[*] Method: Pretexting (urgent email from IT)
[*] Success Rate: 75%
[*] Outcome: Gained access to calendar and contact list.
`, 'success');
                    this.addReputation(20, 'Social engineering campaign executed');
                });
            }
            
            executeCryptoAnalysis(args) {
                const file = args[0] || 'encrypted_file.dat';
                this.startAdvancedExecution(`Analyzing cryptographic file: ${file}`, 50, 90, () => {
                    this.writeOutput(`
[CRYPTO ANALYSIS] Report
---------------------------
[*] File: ${file}
[*] Analysis: 
  - Identified algorithm: AES-256-CBC
  - Identified weak key strength due to entropy analysis.
  - Brute-force attempt successful. Key recovered.
  
[*] Recovered Data:
  - Financial records: Q3_2024_Budget.xls
  - Project plans: Project_Titan.pdf
  
[RESULT] Encrypted data recovered. Weak cryptographic implementation detected.
`, 'success');
                    this.addReputation(40, 'Cryptographic analysis successful');
                });
            }
            
            executeSteganography(args) {
                const file = args[0] || 'image.png';
                this.startAdvancedExecution(`Searching for hidden data in ${file}`, 25, 60, () => {
                    this.writeOutput(`
[STEGANOGRAPHY] Report
-------------------------
[*] File: ${file}
[*] Analysis: 
  - Scanned image for hidden data using LSB (Least Significant Bit) analysis.
  
[+] Hidden payload found!
  - Payload Type: Encrypted text
  - Content: "C2 server is 10.0.0.15 on port 8888. Use 'password' to connect."
  
[RESULT] Hidden command-and-control information extracted.
`, 'success');
                    this.addReputation(25, 'Steganography analysis completed');
                });
            }
            
            executeHoneypot(args) {
                const ip = args[0] || '10.0.0.100';
                this.startAdvancedExecution(`Deploying honeypot at ${ip}`, 15, 30, () => {
                    this.writeOutput(`
[HONEYPOT] Deployment Report
------------------------------
[*] Status: Active
[*] Deployed Services: SSH, FTP, HTTP
[*] Threat Intel: 
  - Detected 15 login attempts from 203.0.113.1
  - Captured exploit attempt for CVE-2022-1234
  
[SUCCESS] Honeypot is active and gathering intelligence on threat actors.
`, 'success');
                    this.addReputation(20, 'Honeypot deployed');
                });
            }

            executeThreatModeling(args) {
                this.startAdvancedExecution(`Analyzing system architecture for threats...`, 30, 50, () => {
                    this.writeOutput(`
[THREAT MODELING] Analysis Report
-----------------------------------
[*] Identified key assets: Customer Database, Source Code Repository
[*] Threat actors: Script Kiddies, State-sponsored Actors, Insider Threats
[*] Attack vectors: SQL Injection, Phishing, Social Engineering
[*] Identified threat: Unauthorized data access via insecure API endpoint.
[*] Mitigation: Implement authentication and rate limiting on API.
`, 'info');
                    this.addReputation(25, 'Threat modeling completed');
                });
            }

            executeComplianceAudit(args) {
                const standard = args[0] || 'GDPR';
                this.startAdvancedExecution(`Performing compliance audit for ${standard}...`, 40, 60, () => {
                    this.writeOutput(`
[COMPLIANCE AUDIT] Report
----------------------------
[*] Standard: ${standard}
[*] Findings:
  - User data not encrypted at rest (GDPR Article 32) [NON-COMPLIANT]
  - Data retention policy not clearly defined (GDPR Article 5) [NON-COMPLIANT]
  - Privacy notices are not accessible (GDPR Article 13) [NON-COMPLIANT]
[*] Corrective actions:
  - Implement full-disk encryption
  - Establish and document data retention policy
`, 'info');
                    this.addReputation(30, 'Compliance audit completed');
                });
            }

            executeRiskAssessment(args) {
                this.startAdvancedExecution(`Executing risk assessment...`, 25, 45, () => {
                    this.writeOutput(`
[RISK ASSESSMENT] Report
--------------------------
[*] Asset: Customer Database
[*] Threat: SQL Injection
[*] Vulnerability: Unsanitized input fields
[*] Likelihood: HIGH
[*] Impact: CRITICAL (data breach)
[*] Overall Risk: CRITICAL
[*] Mitigation: Input sanitization, Web Application Firewall (WAF)
`, 'info');
                    this.addReputation(20, 'Risk assessment completed');
                });
            }

            executeZeroTrust(args) {
                this.startAdvancedExecution(`Simulating Zero Trust architecture...`, 30, 50, () => {
                    this.writeOutput(`
[ZERO TRUST] Simulation
------------------------
[*] Validating all users and devices...
[*] Micro-segmentation applied to network...
[*] Least privilege access controls enabled...
[SUCCESS] All network traffic is now implicitly denied and must be explicitly allowed.
`, 'success');
                    this.addReputation(25, 'Zero Trust simulation completed');
                });
            }

            executeDevSecOps(args) {
                this.startAdvancedExecution(`Integrating security into the development pipeline...`, 35, 60, () => {
                    this.writeOutput(`
[DEVSECOPS] Integration Report
--------------------------------
[*] Static Application Security Testing (SAST) in progress...
[*] Dynamic Application Security Testing (DAST) in progress...
[*] Vulnerability scanning on code dependencies...
[*] Found 2 high-severity vulnerabilities in third-party library 'lodash'.
[*] Build failed. Security gate triggered.
`, 'info');
                    this.addReputation(30, 'DevSecOps process completed');
                });
            }

            executeAISecurity(args) {
                this.startAdvancedExecution(`Executing AI security analysis...`, 40, 70, () => {
                    this.writeOutput(`
[AI SECURITY] Analysis Report
-------------------------------
[*] Method: Adversarial attack on image recognition model
[*] Evasion rate: 95% - Attacker successfully tricked model with modified input.
[*] Outcome: Model identified a stop sign as a yield sign.
[*] Conclusion: The model is vulnerable to adversarial attacks.
`, 'alert');
                    this.addReputation(25, 'AI security analysis completed');
                });
            }
            
            executeQuantumCrypto(args) {
                this.startAdvancedExecution(`Simulating quantum cryptographic key distribution...`, 50, 80, () => {
                    this.writeOutput(`
[QUANTUM CRYPTO] Report
-------------------------
[*] Protocol: BB84
[*] Key Exchange Status: SUCCESS
[*] QKD session established. 
[*] Key length: 256 bits
[*] Eavesdropping detection: The presence of an eavesdropper was detected and the session was immediately terminated.
`, 'success');
                    this.addReputation(40, 'Quantum cryptography simulation completed');
                });
            }

            executeBlockchainAnalysis(args) {
                const tx = args[0] || 'txid12345';
                this.startAdvancedExecution(`Analyzing blockchain transaction: ${tx}`, 25, 50, () => {
                    this.writeOutput(`
[BLOCKCHAIN ANALYSIS] Report
-----------------------------
[*] Transaction ID: ${tx}
[*] Sender Address: 0xAbcDeF...
[*] Recipient Address: 0x123456...
[*] Transaction History: Linked to 3 other suspicious addresses involved in an illicit fund transfer.
`, 'info');
                    this.addReputation(20, 'Blockchain analysis completed');
                });
            }

            executeIoTSecurity(args) {
                const device = args[0] || 'smart_camera';
                this.startAdvancedExecution(`Assessing IoT device security for ${device}...`, 30, 60, () => {
                    this.writeOutput(`
[IoT SECURITY] Assessment Report
---------------------------------
[*] Device: ${device}
[*] Vulnerabilities:
  - Default credentials "admin:admin"
  - Unencrypted communication channel
  - Firmware update process lacks signature verification
[*] Security Score: 3/10
`, 'alert');
                    this.addReputation(25, 'IoT security assessment completed');
                });
            }

            executeCloudSecurity(args) {
                const platform = args[0] || 'AWS';
                this.startAdvancedExecution(`Auditing cloud security for ${platform}...`, 40, 75, () => {
                    this.writeOutput(`
[CLOUD SECURITY] Audit Report
-------------------------------
[*] Platform: ${platform}
[*] Findings:
  - S3 bucket "client-data" publicly accessible.
  - Root account used for daily operations.
  - Missing MFA on critical accounts.
[*] Recommended actions:
  - Set S3 bucket policy to private.
  - Create dedicated IAM roles with least privilege.
  - Enable MFA on all user accounts.
`, 'alert');
                    this.addReputation(30, 'Cloud security assessment completed');
                });
            }

            changeDirectory(path) {
                if (!path) {
                    this.state.currentPath = '/';
                    this.updatePrompt();
                    return;
                }
            
                let newPath;
                if (path === '..') {
                    const pathParts = this.state.currentPath.split('/').filter(p => p);
                    pathParts.pop();
                    newPath = '/' + pathParts.join('/');
                    if (newPath === '') newPath = '/';
                } else if (path.startsWith('/')) {
                    newPath = path.replace(/\/$/, '') || '/';
                } else {
                    newPath = (this.state.currentPath === '/' ? '' : this.state.currentPath) + '/' + path;
                }

                if (this.state.fs.hasOwnProperty(newPath)) {
                    this.state.currentPath = newPath;
                    this.updatePrompt();
                } else {
                    this.writeOutput(`cd: no such file or directory: ${path}`, 'warning');
                }
            }

            listDirectory(path) {
                let targetPath = path || this.state.currentPath;
                if (!targetPath.startsWith('/')) {
                    targetPath = (this.state.currentPath === '/' ? '' : this.state.currentPath) + '/' + targetPath;
                }
                targetPath = targetPath.replace(/\/\//g, '/').replace(/\/$/, '') || '/';
            
                const contents = this.state.fs[targetPath];
                if (contents) {
                    this.writeOutput(contents.join('   '));
                } else {
                    this.writeOutput(`ls: cannot access '${path || targetPath}': No such file or directory`, 'warning');
                }
            }
            
            displayFile(path) {
                let filePath = path;
                if (!filePath.startsWith('/')) {
                    filePath = (this.state.currentPath === '/' ? '' : this.state.currentPath) + '/' + filePath;
                }
            
                const content = this.state.fileContent[filePath];
                if (content) {
                    this.writeOutput(content);
                } else {
                    this.writeOutput(`cat: ${path}: No such file or directory`, 'warning');
                }
            }
            
            updatePrompt() {
                this.prompt.textContent = `root@secferro:${this.state.currentPath}#`;
            }
            
            addReputation(amount, reason) {
                this.state.reputation = Math.min(100, this.state.reputation + amount);
                this.writeOutput(`+${amount} REP: ${reason}`, 'success');
                this.updateSystemStats();
            }
            
            loseReputation(amount, reason) {
                this.state.reputation = Math.max(0, this.state.reputation - amount);
                this.writeOutput(`-${amount} REP: ${reason}`, 'warning');
                this.updateSystemStats();
            }

            startAdvancedExecution(message, time, load, successCallback, failCallback = null) {
                this.writeOutput(`[PROCESS] ${message}...`, 'info');
                this.state.isExecuting = true;
                this.state.cpuLoad = load;
                this.updateSystemStats();

                setTimeout(() => {
                    this.state.isExecuting = false;
                    this.state.cpuLoad = 0;
                    this.updateSystemStats();
                    if (failCallback && Math.random() < 0.2) {
                        failCallback();
                    } else {
                        successCallback();
                    }
                    this.input.focus();
                }, time * 1000);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            window.secFerro = new SecFerroSystem();
        });
    </script>
</body>
</html>
